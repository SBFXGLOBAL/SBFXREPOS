<!DOCTYPE html>

<html>
<head>
	<title>Home Page -</title>
</head>

<body>
	-
	<meta charset="utf-8">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	<link href="/static/content/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="/static/content/site.css" rel="stylesheet" type="text/css">
	<script src="/static/scripts/modernizr-2.6.2.js">
	</script>

	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
				</button> <a class="navbar-brand"
						 href="/">SBFXTOKEN</a>
			</div>


			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li>
						<a href="/home">Hub</a>
					</li>


					<li>
						<a href="/about">Search</a>
					</li>


					<li>
						<a href="/contact">Upload</a>
					</li>
				</ul>
			</div>
		</div>
	</div>


	<div class="container body-content">
		<div class="jumbotron">
			<h1>Flask</h1>


			<p class="lead">
				Flask is a free web framework for building great Web sites and Web applications using HTML, CSS and
				JavaScript.
			</p>


			<p>
				<a class="btn btn-primary btn-large" href="http://flask.pocoo.org/">Learn more »</a>
			</p>
		</div>


		<div class="row">
			<div class="col-md-4">
				<h2>Getting started</h2>


				<p>
					Flask gives you a powerful, patterns-based way to build dynamic websites that enables a clean separation of
					concerns and gives you full control over markup for enjoyable, agile development.
				</p>


				<p>
					<a class="btn btn-default" href="http://flask.pocoo.org/docs/">Learn more »</a>
				</p>
			</div>


			<div class="col-md-4">
				<h2>Get more libraries</h2>


				<p>The Python Package Index is a repository of software for the Python programming language.</p>


				<p>
					<a class="btn btn-default" href="https://pypi.python.org/pypi">Learn more »</a>
				</p>
			</div>


			<div class="col-md-4">
				<h2>Microsoft Azure</h2>


				<p>
					You can easily publish to Microsoft Azure using Visual Studio. Find out how you can host your application using
					a free trial today.
				</p>


				<p>
					<a class="btn btn-default" href="http://azure.microsoft.com">Learn more »</a>
				</p>
			</div>
		</div>
		<meta charset="utf-8">
		<link href="%PUBLIC_URL%/favicon.ico" rel="icon">
		<meta content="width=device-width, initial-scale=1" name="viewport">
		<meta content="#000000" name="theme-color">
		<meta content="Web site created using create-react-app" name="description">
		<link href="%PUBLIC_URL%/logo192.png" rel="apple-touch-icon">
		<!--
		  manifest.json provides metadata used when your web app is installed on a
		  user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
		-->
		<link href="%PUBLIC_URL%/manifest.json" rel="manifest">
		<!--
		  Notice the use of %PUBLIC_URL% in the tags above.
		  It will be replaced with the URL of the `public` folder during the build.
		  Only files inside the `public` folder can be referenced from the HTML.

		  Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
		  work correctly both with client-side routing and a non-root public URL.
		  Learn how to configure a non-root public URL by running `npm run build`.
		-->

		<div id="root">
		</div>
		<noscript>You need to enable JavaScript to run this app.</noscript>

		<div id="root">
		</div>
		<!--
		  This HTML file is a template.
		  If you open it directly in the browser, you will see an empty page.

		  You can add webfonts, meta tags, or analytics to this file.
		  The build step will place the bundled scripts into the <body> tag.

		  To begin the development, run `npm start` or `yarn start`.
		  To create a production bundle, use `npm run build` or `yarn build`.
		-->

		<hr>


		<footer>
			<p>© 2020 - SBFXTOKEN</p>
		</footer>
	</div>
	<script src="/static/scripts/jquery-1.10.2.js">
	</script>
	<script src="/static/scripts/bootstrap.js">
	</script>
	<script src="/static/scripts/respond.js">
	</script>

	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-12">
				<h1 class="display-2">Filebin</h1>
			</div>
		</div>


		<div class="row table-active">
			<div class="col-sm-12">
				<br>


				<p class="lead">
					Convenient file sharing on the web, without registration. Simply upload files and share the URL.
					The files will expire automatically 1 week from now.
				</p>


				<p class="lead">
					<strong>1.</strong> Click <em>Upload files</em> below, or drag and drop the files into this browser
					window.
				</p>


				<p class="lead"><strong>2.</strong> Wait until the file uploads complete.</p>


				<p class="lead">
					<strong>3.</strong> Distribute the <a href="https://filebin.net/tacx0mvwdividff5">URL</a> to share
					access to the files.
				</p>


				<p class="fileUpload btn btn-primary">
					<span><i class="fa fa-cloud-upload"></i> Upload files</span> <input class="upload" id="fileField" multiple type="file">
				</p>
				<br>
			</div>
		</div>
		<br>
		<span id="fileList"></span>

		<div id="fileCount">
		</div>
	</div>


	<div id="dp-container">
		<div>
			<div class="react-draggable" style="touch-action: none; transform: translate(0px, 20px);">
			</div>


			<div>
			</div>
		</div>
	</div>


	<div class="container main text-center">
		<div class="dapp-block" id="info-block">
			<h1 id="name">XPFS</h1>


			<p>Token address: <span class="eth_address" id="creator">0xa5c6717f7f68d8bb11c9b3334dff40d0d4aa6ca5</span></p>


			<p>Token symbol: <span class="eth_address" id="symbol">XPFS</span></p>


			<p>Token decimals: <span class="eth_address" id="decimals">18</span></p>


			<p>Token total supply: <span class="eth_address" id="supply">1000000</span></p>


			<p>Your balance: <span class="eth_address" id="balance">1000000.00000000000</span></p>
		</div>


		<div class="dapp-block" id="send-block">
			<div class="form-group">
				<label for="token-value">Address:</label> <input class="form-control" id="send-address" type="text">
			</div>


			<div class="form-group">
				<label for="token-value">Tokens to send:</label> <input class="form-control" id="token-value" type="number">
			</div>
			<button class="btn btn-success btn-ok" id="send-ok">Send</button> <button class="btn btn-danger btn-cancel" id="send-close">
				Close
			</button>
		</div>


		<div class="dapp-block" id="check-balance-block">
			<div class="form-group">
				<label for="token-value">Check balance of address:</label> <input class="form-control" id="check-address" type="text">
			</div>


			<p id="check-balance">
			</p>
			<button class="btn btn-success btn-ok" id="check-ok">Ok</button> <button class="btn btn-danger btn-cancel" id="check-close">
				Close
			</button>
		</div>


		<div class="dapp-block" id="approve-block">
			<div class="form-group">
				<label for="token-value">Address:</label> <input class="form-control" id="approve-address" type="text">
			</div>


			<div class="form-group">
				<label for="approve-value">Tokens to approve:</label> <input class="form-control" id="approve-value" type="number">
			</div>


			<p id="approve-balance">
			</p>
			<button class="btn btn-success btn-ok" id="approve-ok">Appove</button> <button class="btn btn-success btn-ok" id="approve-check">
				Check current allowance
			</button> <button class="btn btn-danger btn-cancel" id="approve-increase">
				Increase approval
			</button> <button class="btn btn-danger btn-cancel" id="approve-decrease">
				Decrease approval
			</button> <button class="btn btn-danger btn-cancel" id="approve-close">
				Close
			</button>
		</div>


		<div class="dapp-block" id="transfer-from-block">
			<div class="form-group">
				<label for="transfer-from-address">Owner's address:</label> <input class="form-control" id="transfer-from-address"
																	   type="text">
			</div>


			<div class="form-group">
				<label for="transfer-from-to">To:</label> <input class="form-control" id="transfer-from-to" type="text">
			</div>


			<div class="form-group">
				<label for="transfer-from-value">Tokens to spend:</label> <input class="form-control" id="transfer-from-value"
																				 type="number">
			</div>


			<p id="transfer-from-balance">
			</p>
			<button class="btn btn-success btn-ok" id="spend-ok">Spend</button> <button class="btn btn-success btn-ok" id="spend-check">
				Check current allowance
			</button> <button class="btn btn-danger btn-cancel" id="spend-close">
				Close
			</button>
		</div>


		<div class="dapp-block nav-block" style="display: block;">
			<div class="row">
				<div class="col-md-12">
					<button class="btn btn-danger btn-cancel" id="send">Transfer tokens</button>
				</div>


				<div class="col-md-12">
					<button class="btn btn-danger btn-cancel" id="check">Check balance</button>
				</div>


				<div class="col-md-12">
					<button class="btn btn-danger btn-cancel" id="approve">Approve tokens</button>
				</div>


				<div class="col-md-12">
					<button class="btn btn-danger btn-cancel" id="transfer-from">Transfer from</button>
				</div>
			</div>
		</div>
	</div>


	<div class="modal-txn container text-center" style="display: none;">
		<div class="row">
			<div class="col-md-12">
				<h1>Transaction sent.</h1>


				<p>Please wait until it gets mined.</p>


				<p>Information on the page will update automatically.</p>
				<button class="btn btn-success btn-ok ok-back">Ok, back</button>
			</div>
		</div>
	</div>


	<div class="text-center" id="loading-placeholder" style="display: none;">
		<h1>Loading...</h1>


		<p>Waiting for the Smart Contract's response.</p>


		<p>This dApp works in <span style="color: #5bffd9;">Rinkeby Test Network</span>.</p>
	</div>
	<style>
		#loading-placeholder {
			position: fixed;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			background: #bd0088;
			padding-top: 20%;
		}
	</style>
	<script type="text/javascript">
		function managePlaceHolders() {
			if (typeof (web3) == 'undefined' || web3.version.network != "4") return false;
			$('#loading-placeholder').fadeOut();
		}
	</script>
	<script type="text/javascript">
		var dapp = (function () {

			var contract_address = '0xa5c6717f7f68d8bb11c9b3334dff40d0d4aa6ca5';

			let ABI = [{ "constant": true, "inputs": [], "name": "name", "outputs": [{ "name": "", "type": "string" }], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [{ "name": "_spender", "type": "address" }, { "name": "_value", "type": "uint256" }], "name": "approve", "outputs": [{ "name": "", "type": "bool" }], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "totalSupply", "outputs": [{ "name": "", "type": "uint256" }], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [{ "name": "_from", "type": "address" }, { "name": "_to", "type": "address" }, { "name": "_value", "type": "uint256" }], "name": "transferFrom", "outputs": [{ "name": "", "type": "bool" }], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "decimals", "outputs": [{ "name": "", "type": "uint8" }], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [{ "name": "_spender", "type": "address" }, { "name": "_subtractedValue", "type": "uint256" }], "name": "decreaseApproval", "outputs": [{ "name": "", "type": "bool" }], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [{ "name": "_owner", "type": "address" }], "name": "balanceOf", "outputs": [{ "name": "balance", "type": "uint256" }], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "symbol", "outputs": [{ "name": "", "type": "string" }], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [{ "name": "_to", "type": "address" }, { "name": "_value", "type": "uint256" }], "name": "transfer", "outputs": [{ "name": "", "type": "bool" }], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": false, "inputs": [{ "name": "_spender", "type": "address" }, { "name": "_addedValue", "type": "uint256" }], "name": "increaseApproval", "outputs": [{ "name": "", "type": "bool" }], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [{ "name": "_owner", "type": "address" }, { "name": "_spender", "type": "address" }], "name": "allowance", "outputs": [{ "name": "", "type": "uint256" }], "payable": false, "stateMutability": "view", "type": "function" }, { "inputs": [{ "name": "_name", "type": "string" }, { "name": "_symbol", "type": "string" }, { "name": "_decimals", "type": "uint8" }, { "name": "_totalSupply", "type": "uint256" }, { "name": "_beneficiary", "type": "address" }], "payable": false, "stateMutability": "nonpayable", "type": "constructor" }, { "anonymous": false, "inputs": [{ "indexed": true, "name": "from", "type": "address" }, { "indexed": true, "name": "to", "type": "address" }, { "indexed": false, "name": "value", "type": "uint256" }], "name": "Transfer", "type": "event" }, { "anonymous": false, "inputs": [{ "indexed": true, "name": "owner", "type": "address" }, { "indexed": true, "name": "spender", "type": "address" }, { "indexed": false, "name": "value", "type": "uint256" }], "name": "Approval", "type": "event" }];

			let decimals = 0;

			let contract;

			return {
				event: {},
				init: function () {
					contract = web3.eth.contract(ABI).at(contract_address);
					managePlaceHolders();
					this.getDecimals();
					this.getSymbol();
					this.triggers();
					this.watchBalance();
				},
				getDecimals: function () {
					contract.decimals(function (e, d) {
						decimals = d.toNumber();
						$('#decimals').html(d.toNumber());
						dapp.getTotalSupply(d.toNumber());
						dapp.getBalance(d.toNumber());
					})
				},
				getSymbol: function () {
					contract.symbol(function (e, d) {
						$('#symbol').html(d);
					})
				},
				getTotalSupply: function (decimals) {
					contract.totalSupply(function (e, d) {
						$('#supply').html(d.toNumber() / (10 ** decimals));
					})
				},
				getBalance: function (decimals) {
					contract.balanceOf(web3.eth.defaultAccount, function (e, d) {
						if (d) {
							let balance = d.toNumber() / (10 ** decimals);
							$('.nav-block').show();
							if (balance > 0) {
								$('#send').show();
								$('#balance').html(balance.toPrecision(decimals));
							} else {
								$('#send').hide();
								$('#balance').html(balance);
							}
						}
					})
				},
				watchBalance: function () {
					console.log('Watching balance');
					setInterval(function () {
						let currentBalance = +$('#balance').html();
						contract.balanceOf(web3.eth.defaultAccount, function (e, d) {
							if (d) {
								let cbalance = d.toNumber() / (10 ** decimals);
								if (cbalance != currentBalance) {
									console.log('balance changed');
									console.log(cbalance);
									$('#balance').html(cbalance);
								}
								if (cbalance > 0) {
									$('#send').show();
								} else {
									$('#send').hide();
								}
							}
						})
					}, 3000)
				},
				getBalanceOf: function (address) {
					$('#check-balance').html('');
					contract.balanceOf(address, function (e, d) {
						let balance = d.toNumber() / (10 ** decimals);
						$('#check-balance').show();
						$('#check-balance').html(balance + ' tokens');
					})
				},
				triggers: function () {
					$('#send').click(function () {
						$('.nav-block').hide();
						$('#send-block').show();
					});
					$('#send-close').click(function () {
						$('#send-block').hide();
						$('.nav-block').show();
					});
					$('#send-ok').click(function () {
						let value = $('#token-value').val();
						value = +value;
						let to = $('#send-address').val();
						if (value > 0) {
							//если число целое, то добавляем нужное количество нулей
							if ((value ^ 0) === value) {
								value = value * (10 ** decimals);
							} else {
								//ecли не целое, то умножаем на 10 пока не получится целое, считая количество умножений
								let count = 0;
								let val = value * 10;
								while (!(val ^ 0) === val) {
									count++;
									val = val * 10;
								}
								value = value * (10 ** (decimals - count));
							}
							console.log(value);
							contract.transfer(to, value, function (e, d) {
								if (d) {
									dapp.showModal();
								}
							})
						}
					});
					$('.modal-txn .btn-ok').click(function () {
						$('.modal-txn').hide();
						$('#info-block').show();
						$('.nav-block').show();
					});
					$('#check').click(function () {
						$('#check-balance-block').show();
						$('.nav-block').hide();
					});
					$('#check-ok').click(function () {
						let address = $('#check-address').val();
						if (web3.isAddress(address)) {
							dapp.getBalanceOf(address);
						} else {
							$('#check-balance').show();
							$('#check-balance').html('Please enter valid ETH address');
						}
					});
					$('#check-close').click(function () {
						$('#check-balance-block').hide();
						$('.nav-block').show();
					});
					$('#approve').click(function () {
						$('#info-block').hide();
						$('#approve-block').show();
						$('.nav-block').hide();
					});
					$('#approve-ok').click(function () {
						let address = $('#approve-address').val();
						let value = $('#approve-value').val();
						if (web3.isAddress(address)) {
							if (value > 0) {
								//если число целое, то добавляем нужное количество нулей
								if ((value ^ 0) === value) {
									value = value * (10 ** decimals);
								} else {
									//ecли не целое, то умножаем на 10 пока не получится целое, считая количество умножений
									let count = 0;
									let val = value * 10;
									while (!(val ^ 0) === val) {
										count++;
										val = val * 10;
									}
									value = value * (10 ** (decimals - count));
								}
								//console.log(value);
								contract.approve(address, value, function (e, d) {
									if (d) {
										dapp.showModal();
									}
								})
							} else {
								$('#approve-balance').show();
								$('#approve-balance').html('Value should be greater than 0');
							}
						} else {
							$('#approve-balance').show();
							$('#approve-balance').html('Please enter valid ETH address');
						}
					});
					$('#approve-check').click(function () {
						let address = $('#approve-address').val();
						if (web3.isAddress(address)) {
							contract.allowance(web3.eth.defaultAccount, address, function (e, d) {
								let allowance = d.toNumber() / (10 ** decimals);
								$('#approve-balance').show();
								$('#approve-balance').html('Allowance is: ' + allowance + ' tokens');
							})
						} else {
							$('#approve-balance').show();
							$('#approve-balance').html('Please enter valid ETH address');
						}
					});
					$('#approve-close').click(function () {
						$('#info-block').show();
						$('#approve-block').hide();
						$('.nav-block').show();
					});
					$('#approve-increase').click(function () {
						let address = $('#approve-address').val();
						let value = $('#approve-value').val();
						if (web3.isAddress(address)) {
							if (value > 0) {
								//если число целое, то добавляем нужное количество нулей
								if ((value ^ 0) === value) {
									value = value * (10 ** decimals);
								} else {
									//ecли не целое, то умножаем на 10 пока не получится целое, считая количество умножений
									let count = 0;
									let val = value * 10;
									while (!(val ^ 0) === val) {
										count++;
										val = val * 10;
									}
									value = value * (10 ** (decimals - count));
								}
								//console.log(value);
								contract.increaseApproval(address, value, function (e, d) {
									if (d) {
										dapp.showModal();
									}
								})
							} else {
								$('#approve-balance').show();
								$('#approve-balance').html('Value should be greater than 0');
							}
						} else {
							$('#approve-balance').show();
							$('#approve-balance').html('Please enter valid ETH address');
						}
					});
					$('#approve-decrease').click(function () {
						let address = $('#approve-address').val();
						let value = $('#approve-value').val();
						if (web3.isAddress(address)) {
							if (value > 0) {
								//если число целое, то добавляем нужное количество нулей
								if ((value ^ 0) === value) {
									value = value * (10 ** decimals);
								} else {
									//ecли не целое, то умножаем на 10 пока не получится целое, считая количество умножений
									let count = 0;
									let val = value * 10;
									while (!(val ^ 0) === val) {
										count++;
										val = val * 10;
									}
									value = value * (10 ** (decimals - count));
								}
								//console.log(value);
								contract.decreaseApproval(address, value, function (e, d) {
									if (d) {
										dapp.showModal();
									}
								})
							} else {
								$('#approve-balance').show();
								$('#approve-balance').html('Value should be greater than 0');
							}
						} else {
							$('#approve-balance').show();
							$('#approve-balance').html('Please enter valid ETH address');
						}
					});
					$('#transfer-from').click(function () {
						$('#transfer-from-block').show();
						$('.nav-block').hide();
						$('#info-block').hide();
					});
					$('#spend-close').click(function () {
						$('#transfer-from-block').hide();
						$('#info-block').show();
						$('.nav-block').show();
					});
					$('#spend-check').click(function () {
						let address = $('#transfer-from-address').val();
						if (web3.isAddress(address)) {
							contract.allowance(web3.eth.defaultAccount, address, function (e, d) {
								let allowance = d.toNumber() / (10 ** decimals);
								$('#transfer-from-balance').html('Current allowance is ' + allowance + ' tokens');
							})
						} else {
							$('#transfer-from-balance').show().html('Please enter valid ETH address');
						}
					});
					$('#spend-ok').click(function () {
						let address = $('#transfer-from-address').val();
						let value = $('#transfer-from-value').val();
						let to = $('#transfer-from-to').val();
						if (web3.isAddress(address) && web3.isAddress(to)) {
							if (value > 0) {
								//если число целое, то добавляем нужное количество нулей
								if ((value ^ 0) === value) {
									value = value * (10 ** decimals);
								} else {
									//ecли не целое, то умножаем на 10 пока не получится целое, считая количество умножений
									let count = 0;
									let val = value * 10;
									while (!(val ^ 0) === val) {
										count++;
										val = val * 10;
									}
									value = value * (10 ** (decimals - count));
								}
								//console.log(value);
								contract.transferFrom(address, to, value, function (e, d) {
									if (d) {
										dapp.showModal();
									}
								})
							} else {
								$('#transfer-from-balance').show();
								$('#transfer-from-balance').html('Value should be greater than 0');
							}
						} else {
							$('#transfer-from-balance').show();
							$('#transfer-from-balance').html('Please enter valid ETH address');
						}
					})
				},
				showModal: function () {
					$('.modal-txn').show();
					$('#send-block').hide();
					$('#info-block').hide();
					$('#approve-block').hide();
				}
			}
		})();

		window.addEventListener('load', function () {
			if (typeof (window.web3.eth.defaultAccount) != 'undefined' && window.web3.eth.defaultAccount) {
				dapp.init();
			} else {
				var initTimer = setInterval(function () {
					if (typeof (window.web3.eth.defaultAccount) != 'undefined' && window.web3.eth.defaultAccount) {
						dapp.init();
						clearInterval(initTimer);
					}
				}, 1000);
			}
		});
	</script>
	<style>

		.eth_address {
			color: #292929;
			font-size: 14px;
		}

		a, a:focus, a:hover, a:active {
			text-decoration: none;
			color: #292929;
		}

		.btn.btn-danger.btn-cancel {
			background-color: #292929;
			border-color: #000000;
		}

		.btn.btn-success.btn-ok {
			background-color: #ede430;
			border-color: #000000;
		}

			.btn.btn-danger.btn-cancel:hover, .btn.btn-success.btn-ok:hover {
				opacity: 0.8;
			}

		#name {
			color: #292929;
			margin-top: 10px;
		}

		.btn {
			padding: 8px 38px;
			text-transform: uppercase;
			margin: 5px;
		}

		.dapp-block, #nav-block {
			padding-top: 10px;
			padding-bottom: 10px;
		}

		.dapp-block, .delimiter {
			border-bottom: 1px solid #5bffd9;
		}

		.nav-block {
			display: none;
		}

		#send-block {
			display: none;
		}

		#check-balance-block {
			display: none;
		}

		#check-balance {
			display: none;
		}

		#approve-block {
			display: none;
		}

		#transfer-from-block {
			display: none;
		}
	</style>

	<div id="dp-container">
		<div>
			<div class="react-draggable" style="touch-action: none; transform: translate(0px, 20px);">
			</div>


			<div>
			</div>
		</div>
	</div>


	<div id="dp-container">
		<div>
			<div class="react-draggable" style="touch-action: none; transform: translate(0px, 20px);">
			</div>


			<div>
			</div>
		</div>
	</div>
</body>
</html>